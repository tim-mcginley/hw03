ads <- read.csv("data/Advertising.csv")
getwd()
ads <- read.csv("../data/Advertising.csv")
cor(ads[, -1])
help(plot.lm)
plot(ad_data$Sales ~ ad_data[,2:4], which = 1, main= "Ad Budget vs Product Sales Residuals", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
ad_data  <- ads
plot(ad_data$Sales ~ ad_data[,2:4], which = 1, main= "Ad Budget vs Product Sales Residuals", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
plot(ad_data$Sales ~ data.frame(ad_data[,2:4]), which = 1, main= "Ad Budget vs Product Sales Residuals", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
ad_data[,2:4]
plot(ad_data$Sales ~ as.data.frame(ad_data[,2:4]), which = 1, main= "Ad Budget vs Product Sales Residuals", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
plot(reg_obj, which = 1, main= "Ad Budget vs Product Sales Residuals", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
reg_obj <- lm(ad_data$Sales ~ ad_data[,2:4], data = ad_data)
reg_obj <- lm(ad_data$Sales ~ ad_data$TV + ad_data$Radio + ad_data$Newspaper, data = ad_data)
plot(reg_obj, which = 1, main= "Ad Budget vs Product Sales Residuals", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
plot(reg_obj, which = 1, main= "Ad Budget vs Product Sales Residuals")
plot(reg_obj, which = 2, main= "Ad Budget vs Product Sales Scale-Location Plot")
plot(reg_obj, which = 3, main= "Ad Budget vs Product Sales Scale-Location Plot")
plot(reg_obj, which = 2, main= "Ad Budget vs Product Sales")
getwd()
setwd("..")
getwd()
save(cor(ads[, -1]), file = "data/correlation-matrix.RData")
cor_matrix <- cor(ads[, -1])
save(cor_matrix, file = "data/correlation-matrix.RData")
reg_obj
reg_obj[,2]
reg_obj[2]
reg_obj[[2]][1]
reg_obj[[2]]
source('~/.active-rstudio-document')
residual_sum_squares(reg_obj)
summary(RSS)
summary(reg_obj)
reg_obj
reg_obj[[9]]
reg_obj[[10]]
reg_obj[[12]]
reg_obj[[12]][1]
reg_obj[[12]][1][1]
reg_obj[[12]][[1]][1]
reg_obj[[12]][["Sales"]][1]
reg_obj[[12]][[Sales]][1]
reg_obj[[12]][["ad_data$Sales"]][1]
reg_obj[[12]][[1]][1]
source('~/.active-rstudio-document')
total_sum_squares(reg_obj)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
total_sum_squares(reg_obj)
source('~/.active-rstudio-document')
total_sum_squares(reg_obj)
source('~/.active-rstudio-document')
regsum
?regsum
regum()
regsum()
source("data/functions/regression-function.R")
source("data/functions/regression-functions.R")
getwd()
source("code/functions/regression-functions.R")
source('~/Documents/159/hw03/code/functions/regression-functions.R')
source('~/Documents/159/hw03/code/functions/regression-functions.R')
?list.files
list.files()
getwd()
list.files("code/functions")
?test_dir
library(testthat)
?test_dir
getwd()
setwd("/Users/Tim/Documents/159/hw03/code")
sapply
?sapply
functions = list.files("functions", pattern="*.R")
functions = list.files("functions", pattern="*.R", full.names = TRUE)
sapply(functions, source)
sapply(functions, source, .GlobalEnv)
source('~/.active-rstudio-document')
source('~/Documents/159/stat159labs/lab7/test-that/tests/tests.R')
?sink
sessionInfo()
ads <- read.csv("data/Advertising.csv")
getwd()
setwd("..")
getwd()
ads <- read.csv("data/Advertising.csv")
load("../data/regression.Rdata")
getwd()
setwd("report")
load("../data/regression.Rdata")
ad_data <- read.csv("data/Advertising.csv")
reg_obj <- lm(ad_data$Sales ~ ad_data$TV + ad_data$Radio + ad_data$Newspaper, data = ad_data)
reg_sum <- summary(reg_obj)
save(reg_sum, reg_obj, file = "data/regression.RData")
png("images/residual-plot.png")
plot(reg_obj, which = 1, main= "Ad Budget vs Product Sales Residuals")
dev.off()
png("images/scale-location-plot.png")
plot(reg_obj, which = 3, main= "Ad Budget vs Product Sales Scale-Location Plot")
dev.off()
png("images/normal-qq-plot.png")
plot(reg_obj, which = 2, main= "Ad Budget vs Product Sales")
dev.off()
png("images/scatterplot-tv-sales.png")
plot(ad_data$Sales ~ ad_data$TV, main= "TV Ad Budget vs Product Sales", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
abline(reg_obj, col = "darkturquoise", lwd = 5)
dev.off()
png("images/scatterplot-radio-sales.png")
plot(ad_data$Sales ~ ad_data$Radio, main= "Radio Ad Budget vs Product Sales", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
abline(reg_obj, col = "darkturquoise", lwd = 5)
dev.off()
png("images/scatterplot-newspaper-sales.png")
plot(ad_data$Sales ~ ad_data$Newspaper, main= "Print Ad Budget vs Product Sales", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
abline(reg_obj, col = "darkturquoise", lwd = 5)
dev.off()
setwd
setwd('..')
ad_data <- read.csv("data/Advertising.csv")
reg_obj <- lm(ad_data$Sales ~ ad_data$TV + ad_data$Radio + ad_data$Newspaper, data = ad_data)
reg_sum <- summary(reg_obj)
save(reg_sum, reg_obj, file = "data/regression.RData")
png("images/residual-plot.png")
plot(reg_obj, which = 1, main= "Ad Budget vs Product Sales Residuals")
dev.off()
png("images/scale-location-plot.png")
plot(reg_obj, which = 3, main= "Ad Budget vs Product Sales Scale-Location Plot")
dev.off()
png("images/normal-qq-plot.png")
plot(reg_obj, which = 2, main= "Ad Budget vs Product Sales")
dev.off()
png("images/scatterplot-tv-sales.png")
plot(ad_data$Sales ~ ad_data$TV, main= "TV Ad Budget vs Product Sales", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
abline(reg_obj, col = "darkturquoise", lwd = 5)
dev.off()
png("images/scatterplot-radio-sales.png")
plot(ad_data$Sales ~ ad_data$Radio, main= "Radio Ad Budget vs Product Sales", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
abline(reg_obj, col = "darkturquoise", lwd = 5)
dev.off()
png("images/scatterplot-newspaper-sales.png")
plot(ad_data$Sales ~ ad_data$Newspaper, main= "Print Ad Budget vs Product Sales", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
abline(reg_obj, col = "darkturquoise", lwd = 5)
dev.off()
ad_data <- read.csv("data/Advertising.csv")
reg_obj <- lm(ad_data$Sales ~ ad_data$TV + ad_data$Radio + ad_data$Newspaper, data = ad_data)
reg_sum <- summary(reg_obj)
save(reg_sum, reg_obj, file = "data/regression.RData")
png("images/residual-plot.png")
plot(reg_obj, which = 1, main= "Ad Budget vs Product Sales Residuals")
dev.off()
png("images/scale-location-plot.png")
plot(reg_obj, which = 3, main= "Ad Budget vs Product Sales Scale-Location Plot")
dev.off()
png("images/normal-qq-plot.png")
plot(reg_obj, which = 2, main= "Ad Budget vs Product Sales")
dev.off()
png("images/scatterplot-tv-sales.png")
plot(ad_data$Sales ~ ad_data$TV, main= "TV Ad Budget vs Product Sales", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
abline(lm(ad_data$Sales ~ ad_data$TV, data = ad_data), col = "darkturquoise", lwd = 5)
dev.off()
png("images/scatterplot-radio-sales.png")
plot(ad_data$Sales ~ ad_data$Radio, main= "Radio Ad Budget vs Product Sales", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
abline(lm(ad_data$Sales ~ ad_data$Radio, data = ad_data), col = "darkturquoise", lwd = 5)
dev.off()
png("images/scatterplot-newspaper-sales.png")
plot(ad_data$Sales ~ ad_data$Newspaper, main= "Print Ad Budget vs Product Sales", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
abline(lm(ad_data$Sales ~ ad_data$Newspaper, data = ad_data), col = "darkturquoise", lwd = 5)
dev.off()
setwd('report')
load("../data/regression.Rdata")
ads <- read.csv("data/Advertising.csv")
TV_sum <- summary(ads$TV)
Radio_sum <- summary(ads$Radio)
Newspaper_sum <- summary(ads$Newspaper)
Sales_sum <- summary(ads$Sales)
sink('data/eda-output.txt')
print('TV Data Summary:')
TV_sum
print('Radio Data Summary:')
Radio_sum
print('Newspaper Data Summary:')
Newspaper_sum
print('Sales Data Summary:')
Sales_sum
print('Correlation Matrix for all variables')
cor(ads[, -1])
sink()
cor_matrix <- cor(ads[, -1])
save(cor_matrix, file = "data/correlation-matrix.RData")
png("images/histogram-tv.png")
hist(ads$TV, breaks = 12, xlab = "TV Advertising budget by Product", main = 'Investment in TV Ads')
dev.off()
png("images/histogram-radio.png")
hist(ads$TV, breaks = 12, xlab = "Radio Advertising budget by Product", main = 'Investment in Radio Ads')
dev.off()
png("images/histogram-newspaper.png")
hist(ads$TV, breaks = 12, xlab = "Print Advertising budget by Product", main = 'Investment in Newspaper Ads')
dev.off()
png("images/histogram-sales.png")
hist(ads$Sales, breaks = 12, xlab = "Thousands of Units of Sales", main = "Sales by Product")
dev.off()
setwd('..')
ads <- read.csv("data/Advertising.csv")
TV_sum <- summary(ads$TV)
Radio_sum <- summary(ads$Radio)
Newspaper_sum <- summary(ads$Newspaper)
Sales_sum <- summary(ads$Sales)
sink('data/eda-output.txt')
print('TV Data Summary:')
TV_sum
print('Radio Data Summary:')
Radio_sum
print('Newspaper Data Summary:')
Newspaper_sum
print('Sales Data Summary:')
Sales_sum
print('Correlation Matrix for all variables')
cor(ads[, -1])
sink()
cor_matrix <- cor(ads[, -1])
save(cor_matrix, file = "data/correlation-matrix.RData")
png("images/histogram-tv.png")
hist(ads$TV, breaks = 12, xlab = "TV Advertising budget by Product", main = 'Investment in TV Ads')
dev.off()
png("images/histogram-radio.png")
hist(ads$TV, breaks = 12, xlab = "Radio Advertising budget by Product", main = 'Investment in Radio Ads')
dev.off()
png("images/histogram-newspaper.png")
hist(ads$TV, breaks = 12, xlab = "Print Advertising budget by Product", main = 'Investment in Newspaper Ads')
dev.off()
png("images/histogram-sales.png")
hist(ads$Sales, breaks = 12, xlab = "Thousands of Units of Sales", main = "Sales by Product")
dev.off()
setwd('report')
`hw03/data/eda-output.txt`, and histograms of both variables can be can be found in `hw03/images/`.
---
title: "HW03"
author: "Tim McGinley"
date: "October 6, 2016"
output: pdf_document
---
```{r echo = FALSE}
load("../data/regression.Rdata")
load("../data/correlation-matrix.Rdata")
source("../code/functions/regression-functions.R")
```
###Abstract
The goal of this homework assignment is to reproduce the primary findings (regression, charts, and tables) on pages 71-82 of **An Introduction to Statistical Learning** by Gareth James, Daniela Witten, Trevor Hastie and Robert Tibshirani.
##Introduction
Every time a company produces something new, it has a tought decision to make.  See, a new product is useless sitting on the shelves, and the only way people will buy it is if they hear about it through word of mouth or, more commonly, advertising.  So the question is, how much should a company invest in the advertising for one of their products? This report compares the sales figures for various markets for a single product to their market's TV, radio, and newspaper advertising budget and searches for a connection via a multiple linear regression fit.
##Data
The data, located in a file called `Advertising.csv`, contains information about the televison, radio, and newspaper advertising budgets and corresponding sales figures.  The entries for the television budgets are in thousands of dollars, while the figures for sales are in thousands of units sold. Overall, 200 markets are represented, and all 200 have extant information for the three different budgets and total sales.
##Methodology
To conduct the analysis, first the data was loaded from `Advertising.csv` and the variables of interest ("TV" for TV ad budget, "Radio" and "Newspaper" similarly. "Sales" for units sold) were summarised. Summaries can be found in
`hw03/data/eda-output.txt`, and histograms of both variables can be can be found in `hw03/images/`.
To better understand how the three budget variables might relate to the sales figures for a location, I performed a multiple linear regression analysis with the data.  The general idea is that we imagine changes in explanatory variables—in this case ad budgets—begets changes in another variable, here sales figures. These are called the independent and dependent variables, respectively.
In a multiple linear regression, we assume that this relationship can be described roughly by the equation $S = \beta_0+\beta_1(TV)+\beta_2(Radio)+\beta_3(Newspaper)$, where $\beta_x$ are random variables determined from the data by a least-squares fit. The function `lm()` determines these variables from the data for us, and this information as well as a summary are located in `hw03/data/regression.Rdata`.  Scatterplots were constructed using `plot()` and `abline()`.
##Results
Our linear regression analysis produced the results that appear in the following table.  The entries in the table and the paragraph thereafter are inline code and will autogenerate if a different `Advertising.csv` is chosen.
|  |Estimate|Std.Error|t-value|Pr(>ItI)|
|:---:|:---:|:---:|:---:|:---:|
|**(Intercept)**|`r reg_sum[[4]][1]`|`r reg_sum[[4]][3]`|`r reg_sum[[4]][5]`|`r reg_sum[[4]][7]`|
|**TV ($(\beta_1)$)**|`r reg_sum[[4]][2]`|`r reg_sum[[4]][4]`|`r reg_sum[[4]][6]`|`r reg_sum[[4]][8]`|
Table: ***Simple Regression of Sales on TV***
This analysis shows that, using this model, each thousand dollars spent on TV advertising for a product increases that product's sales by about `r round((reg_sum[[4]][2])*(1000), 1)` units.  It also implies that spending zero dollars on advertising results in sales of around `r round((reg_sum[[4]][1])*(1000), 0)` units, which is fairly suspect when one looks at the scatterplot of the dependent and independent variables against one another (The regression line is drawn in teal).
![](../images/scatterplot-tv-sales.png)
This shows that in practice, markets with small ad budgets do not have sales as high as the intercept of the linear model would suggest.  In general, this is a shortcoming of linear models:  any curvature to the data at all and the relationship becomes less reliable.  One can gleam some idea of how good a linear fit is at representing a relationship in data by calculating the following statistics about the fit.
|**Statistic**|**Value**|
|:---:|:---:|
|**RSS**|`r reg_sum[[6]][1]`|
|**$R^2$**| `r reg_sum[[8]][1]`|
|**F-stat**| `r reg_sum[[10]][1]`|
Table: ***Goodness of Fit Statistics***
Residual sum of squares, or *RSS*, is a statistic computed using the forumula $RSS = \sum_{i=1}^n (y_i - f(x_i))^2$, where the $y_i$ values are the true value of the sales for a given markey while the $f(x_i)$ values are the expected sales based on the TV ad budget according to our model.  The least-squares fit is the fit that finds $\beta_0$ and $\beta_1$ so as to make the RSS as small as possible.
The $R^2$ statistic is a measure of how closely the data falls along the regression line.  If all data points were perfectly along this line, $R^2 = 1$.  Instead, we have $R^2 = `r reg_sum[[8]][1]`$
The F-statistic displayed above is the ratio $\frac{\text{Mean Squared Error of } f(x_i) \text{ values}}{\text{Mean Squared Error of Error terms } (y_i - f(x_i))}$, and could be used if desired to asses goodness of fit using an F-test.
##Conclusions
Clearly, the linear regression model fits this data well, but certainly not perfectly. An $R^2$ value of `r reg_sum[[8]][1]` means the line fits the data reasonably well as $`r reg_sum[[8]][1]` > 0.5$.  This means that for the majority of markets, increasing the TV ad budget for a product by $1000 will result in an increase in sales of about `r round((reg_sum[[4]][2]*1000), 1)` units.
reg_sum[[4]][1]
reg_sum[[4]]
ad_data <- read.csv("data/Advertising.csv")
reg_obj <- lm(ad_data$Sales ~ ad_data$TV + ad_data$Radio + ad_data$Newspaper, data = ad_data)
reg_sum <- summary(reg_obj)
reg_obj1 <- lm(ad_data$Sales ~ ad_data$TV, data = ad_data)
reg_sum1 <- summary(reg_obj1)
reg_obj2 <- lm(ad_data$Sales ~ ad_data$Radio, data = ad_data)
reg_sum2 <- summary(reg_obj2)
reg_obj3 <- lm(ad_data$Sales ~ ad_data$Newspaper, data = ad_data)
reg_sum3 <- summary(reg_obj3)
save(reg_sum1, reg_sum, reg_sum2, reg_sum3, reg_obj, reg_obj1, reg_obj2, reg_obj3, file = "data/regression.RData")
png("images/residual-plot.png")
plot(reg_obj, which = 1, main= "Ad Budget vs Product Sales Residuals")
dev.off()
png("images/scale-location-plot.png")
plot(reg_obj, which = 3, main= "Ad Budget vs Product Sales Scale-Location Plot")
dev.off()
png("images/normal-qq-plot.png")
plot(reg_obj, which = 2, main= "Ad Budget vs Product Sales")
dev.off()
png("images/scatterplot-tv-sales.png")
plot(ad_data$Sales ~ ad_data$TV, main= "TV Ad Budget vs Product Sales", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
abline(lm(ad_data$Sales ~ ad_data$TV, data = ad_data), col = "darkturquoise", lwd = 5)
dev.off()
png("images/scatterplot-radio-sales.png")
plot(ad_data$Sales ~ ad_data$Radio, main= "Radio Ad Budget vs Product Sales", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
abline(lm(ad_data$Sales ~ ad_data$Radio, data = ad_data), col = "darkturquoise", lwd = 5)
dev.off()
png("images/scatterplot-newspaper-sales.png")
plot(ad_data$Sales ~ ad_data$Newspaper, main= "Print Ad Budget vs Product Sales", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
abline(lm(ad_data$Sales ~ ad_data$Newspaper, data = ad_data), col = "darkturquoise", lwd = 5)
dev.off()
setwd('..')
ad_data <- read.csv("data/Advertising.csv")
reg_obj <- lm(ad_data$Sales ~ ad_data$TV + ad_data$Radio + ad_data$Newspaper, data = ad_data)
reg_sum <- summary(reg_obj)
reg_obj1 <- lm(ad_data$Sales ~ ad_data$TV, data = ad_data)
reg_sum1 <- summary(reg_obj1)
reg_obj2 <- lm(ad_data$Sales ~ ad_data$Radio, data = ad_data)
reg_sum2 <- summary(reg_obj2)
reg_obj3 <- lm(ad_data$Sales ~ ad_data$Newspaper, data = ad_data)
reg_sum3 <- summary(reg_obj3)
save(reg_sum1, reg_sum, reg_sum2, reg_sum3, reg_obj, reg_obj1, reg_obj2, reg_obj3, file = "data/regression.RData")
png("images/residual-plot.png")
plot(reg_obj, which = 1, main= "Ad Budget vs Product Sales Residuals")
dev.off()
png("images/scale-location-plot.png")
plot(reg_obj, which = 3, main= "Ad Budget vs Product Sales Scale-Location Plot")
dev.off()
png("images/normal-qq-plot.png")
plot(reg_obj, which = 2, main= "Ad Budget vs Product Sales")
dev.off()
png("images/scatterplot-tv-sales.png")
plot(ad_data$Sales ~ ad_data$TV, main= "TV Ad Budget vs Product Sales", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
abline(lm(ad_data$Sales ~ ad_data$TV, data = ad_data), col = "darkturquoise", lwd = 5)
dev.off()
png("images/scatterplot-radio-sales.png")
plot(ad_data$Sales ~ ad_data$Radio, main= "Radio Ad Budget vs Product Sales", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
abline(lm(ad_data$Sales ~ ad_data$Radio, data = ad_data), col = "darkturquoise", lwd = 5)
dev.off()
png("images/scatterplot-newspaper-sales.png")
plot(ad_data$Sales ~ ad_data$Newspaper, main= "Print Ad Budget vs Product Sales", xlab= "Ad Budget in Thousands of Dollars", ylab = "Thousands of Unit Sales")
abline(lm(ad_data$Sales ~ ad_data$Newspaper, data = ad_data), col = "darkturquoise", lwd = 5)
dev.off()
setwd('report')
reg_sum[[4]]
reg_sum[[4]][1]
reg_sum[[4]][2]
reg_sum[[4]][3]
cor_matrix
reg_sum[[8]]
reg_sum[8]
reg_sum['r.squared']
load("../data/regression.Rdata")
load("../data/correlation-matrix.Rdata")
source("../code/functions/regression-functions.R")
getwd()
residual_std_error(reg_obj)
View(r_squared)
